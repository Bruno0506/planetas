import cv2
from yolov4tiny import YoloV4Tiny  # Asegúrate de tener tu modelo cargado

# Inicializar la cámara USB
cap = cv2.VideoCapture(0)  # "0" selecciona la primera cámara conectada (tu LifeCam)

if not cap.isOpened():
    print("Error: No se pudo abrir la cámara.")
else:
    # Configura la resolución si es necesario
    cap.set(cv2.CAP_PROP_FRAME_WIDTH, 640)
    cap.set(cv2.CAP_PROP_FRAME_HEIGHT, 480)

    while True:
        ret, frame = cap.read()
        if not ret:
            print("Error: No se pudo capturar el frame.")
            break

        # Aquí puedes insertar el código de detección con YOLO
        results = YoloV4Tiny.detect(frame)
        for (x, y, w, h) in results:
            cv2.rectangle(frame, (x, y), (x+w, y+h), (0, 255, 0), 2)

        # Mostrar la imagen con las detecciones
        cv2.imshow("Detección de Objetos", frame)

        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()
